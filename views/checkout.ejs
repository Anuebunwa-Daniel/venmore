<%- include('layout/user-header.ejs') %>
  <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

      <!-- Breadcrumb -->
    <div class="container mt-5 pt-5">
        </nav>
    </div>

    <!-- Category Header -->
    <section class="category-header">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h1>
                        Checkout
                    </h1>
                    <h5 class="text-muted">After payment, your order will be delivered to on or before two working days </h5>
                </div>
            </div>
        </div>
    </section>

<div class="container my-5">
  <h2>What you ordered</h2>


  <% if(cart.length > 0){ %>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Product</th>
          <th>Qty</th>
          <th>Price</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        <% cart.forEach(item => { %>
          <tr>
            <td><%= item.name %></td>
            <td><%= item.qty %></td>
            <td>$<%= item.price %></td>
            <td>$<%= item.price * item.qty %></td>
          </tr>
        <% }) %>
      </tbody>
    </table>

    <h4>Grand Total: $<%= total %></h4>

    <form id="checkout-form" action="/pay" method="POST">
      <button type="submit" class="btn btn-success ">Pay Now</button>
    </form>

  <% } else { %>
    <p>Your cart is empty.</p>
  <% } %>
</div>

<!-- <script>
document.getElementById('checkout-form')?.addEventListener('submit', async (e) => {
  e.preventDefault();

  try {
    const res = await fetch('/checkout', { method: 'POST' });
    const data = await res.json();

    if (data.success) {
      alert(data.message);
      window.location.href = '/'; // Redirect to home or orders page
    }
  } catch (err) {
    console.error(err);
    alert('Error placing order.');
  }
});
</script> -->

<%- include('layout/user-footer.ejs') %>
